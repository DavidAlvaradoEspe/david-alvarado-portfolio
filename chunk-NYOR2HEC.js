import{a as m}from"./chunk-CJK33JLH.js";var T=new RegExp("\\.(\\w{3,4})($|\\?)"),n=100,c=new Float32Array([0,0]),l=null,u=null,h=null;function w(){if(!u){u=new Float32Array(n);let r=1/(n-1),e=r;for(let t=1;t<n;t++)u[t]=Math.exp(-11.512925464970227*(1-e)),e+=r}return u}function v(){if(!h){h=new Float32Array(n);let r=1/n,e=r;for(let t=0;t<n;t++)h[t]=1+Math.log10(e)/Math.log10(n),e+=r}return h}function p(r,e,t){l||(l=new Float32Array(n));let s;if(r==="linear")return c[0]=e,c[1]=t,c;if(r==="exponential")s=w();else if(r==="logarithmic")s=v();else throw new Error(`Unknown ramp shape: ${r}`);let a=Math.sign(t-e),i=Math.abs(t-e);if(a===1)for(let o=0;o<s.length;o++)l[o]=e+i*s[o];else{let o=n-1;for(let _=0;_<s.length;_++,o--)l[_]=e-i*(1-s[o])}return l}function S(r){return r.replace(/#/gm,"%23")}var x=1e-6,d=class{constructor(e,t){this._rampEndTime=0,this._engine=e,this._param=t,this._targetValue=t.value}get isRamping(){return this._engine.currentTime<this._rampEndTime}get targetValue(){return this._targetValue}set targetValue(e){this.setTargetValue(e)}get value(){return this._param.value}dispose(){this._param=null,this._engine=null}setTargetValue(e,t=null){let s=typeof t?.shape=="string"?t.shape:"linear",a=this._engine.currentTime;if(s==="none"){this._param.cancelScheduledValues(a),this._param.value=this._targetValue=e,this._rampEndTime=a;return}let i=typeof t?.duration=="number"?Math.max(t.duration,this._engine.parameterRampDuration):this._engine.parameterRampDuration;if((i=Math.max(this._engine.parameterRampDuration,i))<x){this._param.setValueAtTime(this._targetValue=e,a);return}this._param.cancelScheduledValues(a),this._param.setValueCurveAtTime(p(s,this._param.value,this._targetValue=e),a,i),this._rampEndTime=a+i}};var f=class{constructor(e,t){this.onDisposeObservable=new m,this.engine=e,t&1&&(this._upstreamNodes=new Set),t&2&&(this._downstreamNodes=new Set)}dispose(){if(this._downstreamNodes){for(let e of Array.from(this._downstreamNodes))if(!this._disconnect(e))throw new Error("Disconnect failed");this._downstreamNodes.clear()}if(this._upstreamNodes){for(let e of Array.from(this._upstreamNodes))if(!e._disconnect(this))throw new Error("Disconnect failed");this._upstreamNodes.clear()}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()}_connect(e){return!this._downstreamNodes||this._downstreamNodes.has(e)||!e._onConnect(this)?!1:(this._downstreamNodes.add(e),!0)}_disconnect(e){return!this._downstreamNodes||!this._downstreamNodes.delete(e)?!1:e._onDisconnect(this)}_onConnect(e){return!this._upstreamNodes||this._upstreamNodes.has(e)?!1:(this._upstreamNodes.add(e),!0)}_onDisconnect(e){return this._upstreamNodes?.delete(e)??!1}},g=class extends f{constructor(e,t,s){super(t,s),this.onNameChangedObservable=new m,this._name=e}get name(){return this._name}set name(e){if(this._name===e)return;let t=this._name;this._name=e,this.onNameChangedObservable.notifyObservers({newName:e,oldName:t,node:this})}dispose(){super.dispose(),this.onNameChangedObservable.clear()}};export{T as a,S as b,d as c,f as d,g as e};
