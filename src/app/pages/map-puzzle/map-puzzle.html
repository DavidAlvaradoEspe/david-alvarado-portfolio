<div class="closed-map-container">
  <canvas #renderCanvas class="render-canvas"></canvas>


  @if(!puzzleStore.isUnlocked() && !puzzleStore.isLoading()){
    <div class="puzzle-hints">
      <h1 class="hint-title" [translate]="'Unlock Map'"></h1>
      <div class="sequence-display">
        @for (direction of SEQUENCE_DISPLAY; track direction ; let i = $index) {
          <span
            class="sequence-step"
            [class.completed]="i < puzzleStep()"
            [class.active]="i === puzzleStep()">

            @if (direction === 'right') {
              <svg viewBox="0 0 24 24" class="step-icon">
                <path fill="currentColor" d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
              </svg>
            }
            @if (direction === 'down') {
              <svg viewBox="0 0 24 24" class="step-icon">
                <path fill="currentColor" d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"/>
              </svg>
            }
            @if (direction === 'left') {
              <svg viewBox="0 0 24 24" class="step-icon">
                <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
              </svg>
            }
          </span>
        }
      </div>
    </div>

    <div class="swipe-guide-overlay">
      <div class="hand-container"
           [class.anim-right]="puzzleStep() === 0"
           [class.anim-down]="puzzleStep() === 1"
           [class.anim-left]="puzzleStep() === 2">

        <svg class="hand-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C12.5523 2 13 2.44772 13 3V13C13 13.5523 13.4477 14 14 14C14.5523 14 15 13.5523 15 13V5C15 4.44772 15.4477 4 16 4C16.5523 4 17 4.44772 17 5V13C17 13.5523 17.4477 14 18 14C18.5523 14 19 13.5523 19 13V7C19 6.44772 19.4477 6 20 6C20.5523 6 21 6.44772 21 7V15.5C21 19.0899 18.0899 22 14.5 22H9.5C5.91015 22 3 19.0899 3 15.5V11C3 10.4477 3.44772 10 4 10C4.5523 10 5 10.4477 5 11V16C5 16.5523 5.44772 17 6 17C6.5523 17 7 16.5523 7 16V3C7 2.44772 7.44772 2 8 2C8.5523 2 9 2.44772 9 3V11C9 11.5523 9.44772 12 10 12C10.5523 12 11 11.5523 11 11V3C11 2.44772 11.4477 2 12 2Z" fill="currentColor"/>
        </svg>

        <div class="touch-point"></div>
      </div>

      <div class="guide-text">
        @switch(puzzleStep()) {
          @case(0) { <span [translate]="'Swipe Right'"></span> }
          @case(1) { <span [translate]="'Swipe Down'"></span> }
          @case(2) { <span [translate]="'Swipe Left'"></span> }
        }
      </div>
    </div>
  }
</div>
