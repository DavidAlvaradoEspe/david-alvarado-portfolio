import{a as H}from"./chunk-R3OZJ4HQ.js";import{h as y}from"./chunk-ONKGPWX4.js";import{a as v,b as F}from"./chunk-ICZKPOAS.js";import{a as D}from"./chunk-DTW6C2NU.js";import{d as w}from"./chunk-7CJVMH7M.js";import{b as A}from"./chunk-NPZEPKVW.js";import{c as T,d as _,f as b,g as c}from"./chunk-FWZ75RMU.js";import{a as m,d as p,e as S}from"./chunk-CCUABLZY.js";import{a as R}from"./chunk-3WG2WLZ4.js";D.AddNodeConstructor("Light_Type_2",(e,t)=>()=>new u(e,_.Zero(),_.Zero(),0,0,t));var u=class e extends F{get iesProfileTexture(){return this._iesProfileTexture}set iesProfileTexture(t){this._iesProfileTexture!==t&&(this._iesProfileTexture=t,this._iesProfileTexture&&e._IsTexture(this._iesProfileTexture)&&this._iesProfileTexture.onLoadObservable.addOnce(()=>{this._markMeshesAsLightDirty()}))}get angle(){return this._angle}set angle(t){this._angle=t,this._cosHalfAngle=Math.cos(t*.5),this._projectionTextureProjectionLightDirty=!0,this.forceProjectionMatrixCompute(),this._computeAngleValues()}get innerAngle(){return this._innerAngle}set innerAngle(t){this._innerAngle=t,this._computeAngleValues()}get shadowAngleScale(){return this._shadowAngleScale}set shadowAngleScale(t){this._shadowAngleScale=t,this.forceProjectionMatrixCompute()}get projectionTextureMatrix(){return this._projectionTextureMatrix}get projectionTextureLightNear(){return this._projectionTextureLightNear}set projectionTextureLightNear(t){this._projectionTextureLightNear=t,this._projectionTextureProjectionLightDirty=!0}get projectionTextureLightFar(){return this._projectionTextureLightFar}set projectionTextureLightFar(t){this._projectionTextureLightFar=t,this._projectionTextureProjectionLightDirty=!0}get projectionTextureUpDirection(){return this._projectionTextureUpDirection}set projectionTextureUpDirection(t){this._projectionTextureUpDirection=t,this._projectionTextureProjectionLightDirty=!0}get projectionTexture(){return this._projectionTexture}set projectionTexture(t){this._projectionTexture!==t&&(this._projectionTexture=t,this._projectionTextureDirty=!0,this._projectionTexture&&!this._projectionTexture.isReady()&&(e._IsProceduralTexture(this._projectionTexture)?this._projectionTexture.getEffect().executeWhenCompiled(()=>{this._markMeshesAsLightDirty()}):e._IsTexture(this._projectionTexture)&&this._projectionTexture.onLoadObservable.addOnce(()=>{this._markMeshesAsLightDirty()})))}static _IsProceduralTexture(t){return t.onGeneratedObservable!==void 0}static _IsTexture(t){return t.onLoadObservable!==void 0}get projectionTextureProjectionLightMatrix(){return this._projectionTextureProjectionLightMatrix}set projectionTextureProjectionLightMatrix(t){this._projectionTextureProjectionLightMatrix=t,this._projectionTextureProjectionLightDirty=!1,this._projectionTextureDirty=!0}constructor(t,r,o,n,a,s){super(t,s),this._innerAngle=0,this._iesProfileTexture=null,this._projectionTextureMatrix=c.Zero(),this._projectionTextureLightNear=1e-6,this._projectionTextureLightFar=1e3,this._projectionTextureUpDirection=_.Up(),this._projectionTextureViewLightDirty=!0,this._projectionTextureProjectionLightDirty=!0,this._projectionTextureDirty=!0,this._projectionTextureViewTargetVector=_.Zero(),this._projectionTextureViewLightMatrix=c.Zero(),this._projectionTextureProjectionLightMatrix=c.Zero(),this._projectionTextureScalingMatrix=c.FromValues(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1),this.position=r,this.direction=o,this.angle=n,this.exponent=a}getClassName(){return"SpotLight"}getTypeID(){return v.LIGHTTYPEID_SPOTLIGHT}_setDirection(t){super._setDirection(t),this._projectionTextureViewLightDirty=!0}_setPosition(t){super._setPosition(t),this._projectionTextureViewLightDirty=!0}_setDefaultShadowProjectionMatrix(t,r,o){let n=this.getScene().activeCamera;if(!n)return;this._shadowAngleScale=this._shadowAngleScale||1;let a=this._shadowAngleScale*this._angle,s=this.shadowMinZ!==void 0?this.shadowMinZ:n.minZ,h=this.shadowMaxZ!==void 0?this.shadowMaxZ:n.maxZ,g=this.getScene().getEngine().useReverseDepthBuffer;c.PerspectiveFovLHToRef(a,1,g?h:s,g?s:h,t,!0,this._scene.getEngine().isNDCHalfZRange,void 0,g)}_computeProjectionTextureViewLightMatrix(){this._projectionTextureViewLightDirty=!1,this._projectionTextureDirty=!0,this.getAbsolutePosition().addToRef(this.getShadowDirection(),this._projectionTextureViewTargetVector),c.LookAtLHToRef(this.getAbsolutePosition(),this._projectionTextureViewTargetVector,this._projectionTextureUpDirection,this._projectionTextureViewLightMatrix)}_computeProjectionTextureProjectionLightMatrix(){this._projectionTextureProjectionLightDirty=!1,this._projectionTextureDirty=!0;let t=this.projectionTextureLightFar,r=this.projectionTextureLightNear,o=t/(t-r),n=-o*r,a=1/Math.tan(this._angle/2);c.FromValuesToRef(a/1,0,0,0,0,a,0,0,0,0,o,1,0,0,n,0,this._projectionTextureProjectionLightMatrix)}_computeProjectionTextureMatrix(){if(this._projectionTextureDirty=!1,this._projectionTextureViewLightMatrix.multiplyToRef(this._projectionTextureProjectionLightMatrix,this._projectionTextureMatrix),this._projectionTexture instanceof w){let t=this._projectionTexture.uScale/2,r=this._projectionTexture.vScale/2;c.FromValuesToRef(t,0,0,0,0,r,0,0,0,0,.5,0,.5,.5,.5,1,this._projectionTextureScalingMatrix)}this._projectionTextureMatrix.multiplyToRef(this._projectionTextureScalingMatrix,this._projectionTextureMatrix)}_buildUniformLayout(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightDirection",3),this._uniformBuffer.addUniform("vLightFalloff",4),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}_computeAngleValues(){this._lightAngleScale=1/Math.max(.001,Math.cos(this._innerAngle*.5)-this._cosHalfAngle),this._lightAngleOffset=-this._cosHalfAngle*this._lightAngleScale}transferTexturesToEffect(t,r){return this.projectionTexture&&this.projectionTexture.isReady()&&(this._projectionTextureViewLightDirty&&this._computeProjectionTextureViewLightMatrix(),this._projectionTextureProjectionLightDirty&&this._computeProjectionTextureProjectionLightMatrix(),this._projectionTextureDirty&&this._computeProjectionTextureMatrix(),t.setMatrix("textureProjectionMatrix"+r,this._projectionTextureMatrix),t.setTexture("projectionLightTexture"+r,this.projectionTexture)),this._iesProfileTexture&&this._iesProfileTexture.isReady()&&t.setTexture("iesLightTexture"+r,this._iesProfileTexture),this}transferToEffect(t,r){let o,n=this._scene.floatingOriginOffset;return this.computeTransformedInformation()?(this._uniformBuffer.updateFloat4("vLightData",this.transformedPosition.x-n.x,this.transformedPosition.y-n.y,this.transformedPosition.z-n.z,this.exponent,r),o=_.Normalize(this.transformedDirection)):(this._uniformBuffer.updateFloat4("vLightData",this.position.x-n.x,this.position.y-n.y,this.position.z-n.z,this.exponent,r),o=_.Normalize(this.direction)),this._uniformBuffer.updateFloat4("vLightDirection",o.x,o.y,o.z,this._cosHalfAngle,r),this._uniformBuffer.updateFloat4("vLightFalloff",this.range,this._inverseSquaredRange,this._lightAngleScale,this._lightAngleOffset,r),this}transferToNodeMaterialEffect(t,r){let o;return this.computeTransformedInformation()?o=_.Normalize(this.transformedDirection):o=_.Normalize(this.direction),this.getScene().useRightHandedSystem?t.setFloat3(r,-o.x,-o.y,-o.z):t.setFloat3(r,o.x,o.y,o.z),this}dispose(){super.dispose(),this._projectionTexture&&this._projectionTexture.dispose(),this._iesProfileTexture&&(this._iesProfileTexture.dispose(),this._iesProfileTexture=null)}getDepthMinZ(t){let r=this._scene.getEngine(),o=this.shadowMinZ!==void 0?this.shadowMinZ:t?.minZ??0;return r.useReverseDepthBuffer&&r.isNDCHalfZRange?o:this._scene.getEngine().isNDCHalfZRange?0:o}getDepthMaxZ(t){let r=this._scene.getEngine(),o=this.shadowMaxZ!==void 0?this.shadowMaxZ:t?.maxZ??1e4;return r.useReverseDepthBuffer&&r.isNDCHalfZRange?0:o}prepareLightSpecificDefines(t,r){t["SPOTLIGHT"+r]=!0,t["PROJECTEDLIGHTTEXTURE"+r]=!!(this.projectionTexture&&this.projectionTexture.isReady()),t["IESLIGHTTEXTURE"+r]=!!(this._iesProfileTexture&&this._iesProfileTexture.isReady())}};m([p()],u.prototype,"angle",null);m([p()],u.prototype,"innerAngle",null);m([p()],u.prototype,"shadowAngleScale",null);m([p()],u.prototype,"exponent",void 0);m([p()],u.prototype,"projectionTextureLightNear",null);m([p()],u.prototype,"projectionTextureLightFar",null);m([p()],u.prototype,"projectionTextureUpDirection",null);m([S("projectedLightTexture")],u.prototype,"_projectionTexture",void 0);R("BABYLON.SpotLight",u);var K=[{regex:new RegExp("^/nodes/\\d+/extensions/")}],P=class{constructor(t,r){this._gltf=t,this._infoTree=r}convert(t){let r=this._gltf,o=this._infoTree,n;if(!t.startsWith("/"))throw new Error("Path must start with a /");let a=t.split("/");if(a.shift(),a[a.length-1].includes(".length")){let g=a[a.length-1].split(".");a.pop(),a.push(...g)}let s=!1;for(let h of a){let g=h==="length";if(g&&!o.__array__)throw new Error(`Path ${t} is invalid`);if(o.__ignoreObjectTree__&&(s=!0),o.__array__&&!g)o=o.__array__;else if(o=o[h],!o)throw new Error(`Path ${t} is invalid`);if(!s)if(r===void 0){if(!K.find(L=>L.regex.test(t)))throw new Error(`Path ${t} is invalid`)}else g||(r=r?.[h]);(o.__target__||g)&&(n=r)}return{object:n,info:o}}};var V={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonTransformNode),getPropertyName:[()=>"length"]},__array__:{__target__:!0,translation:{type:"Vector3",get:e=>e._babylonTransformNode?.position,set:(e,t)=>t._babylonTransformNode?.position.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"position"]},rotation:{type:"Quaternion",get:e=>e._babylonTransformNode?.rotationQuaternion,set:(e,t)=>t._babylonTransformNode?.rotationQuaternion?.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"rotationQuaternion"]},scale:{type:"Vector3",get:e=>e._babylonTransformNode?.scaling,set:(e,t)=>t._babylonTransformNode?.scaling.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"scaling"]},weights:{length:{type:"number",get:e=>e._numMorphTargets,getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},__array__:{__target__:!0,type:"number",get:(e,t)=>t!==void 0?e._primitiveBabylonMeshes?.[0].morphTargetManager?.getTarget(t).influence:void 0,getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},type:"number[]",get:(e,t)=>[0],getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},matrix:{type:"Matrix",get:e=>c.Compose(e._babylonTransformNode?.scaling,e._babylonTransformNode?.rotationQuaternion,e._babylonTransformNode?.position),getTarget:e=>e._babylonTransformNode,isReadOnly:!0},globalMatrix:{type:"Matrix",get:e=>{let t=c.Identity(),r=e.parent;for(;r&&r.parent;)r=r.parent;let o=e._babylonTransformNode?.position._isDirty||e._babylonTransformNode?.rotationQuaternion?._isDirty||e._babylonTransformNode?.scaling._isDirty;if(r){let n=r._babylonTransformNode?.computeWorldMatrix(!0).invert();n&&e._babylonTransformNode?.computeWorldMatrix(o)?.multiplyToRef(n,t)}else e._babylonTransformNode&&t.copyFrom(e._babylonTransformNode.computeWorldMatrix(o));return t},getTarget:e=>e._babylonTransformNode,isReadOnly:!0},extensions:{EXT_lights_ies:{multiplier:{type:"number",get:e=>e._babylonTransformNode?.getChildren(t=>t instanceof u,!0)[0]?.intensity,getTarget:e=>e._babylonTransformNode?.getChildren(t=>t instanceof u,!0)[0],set:(e,t)=>{if(t._babylonTransformNode){let r=t._babylonTransformNode.getChildren(o=>o instanceof u,!0)[0];r&&(r.intensity=e)}}},color:{type:"Color3",get:e=>e._babylonTransformNode?.getChildren(t=>t instanceof u,!0)[0]?.diffuse,getTarget:e=>e._babylonTransformNode?.getChildren(t=>t instanceof u,!0)[0],set:(e,t)=>{if(t._babylonTransformNode){let r=t._babylonTransformNode.getChildren(o=>o instanceof u,!0)[0];r&&(r.diffuse=e)}}}},KHR_node_visibility:{visible:{type:"boolean",get:e=>e._primitiveBabylonMeshes?e._primitiveBabylonMeshes[0].isVisible:!1,getTarget:()=>{},set:(e,t)=>{t._primitiveBabylonMeshes&&t._primitiveBabylonMeshes.forEach(r=>r.isVisible=e)}}}}}},E={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonAnimationGroup),getPropertyName:[()=>"length"]},__array__:{}},B={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t.primitives[0]._instanceData?.babylonSourceMesh),getPropertyName:[()=>"length"]},__array__:{}},O={__array__:{__target__:!0,orthographic:{xmag:{componentsCount:2,type:"Vector2",get:e=>new T(e._babylonCamera?.orthoLeft??0,e._babylonCamera?.orthoRight??0),set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.orthoLeft=e.x,t._babylonCamera.orthoRight=e.y)},getTarget:e=>e,getPropertyName:[()=>"orthoLeft",()=>"orthoRight"]},ymag:{componentsCount:2,type:"Vector2",get:e=>new T(e._babylonCamera?.orthoBottom??0,e._babylonCamera?.orthoTop??0),set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.orthoBottom=e.x,t._babylonCamera.orthoTop=e.y)},getTarget:e=>e,getPropertyName:[()=>"orthoBottom",()=>"orthoTop"]},zfar:{type:"number",get:e=>e._babylonCamera?.maxZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.maxZ=e)},getTarget:e=>e,getPropertyName:[()=>"maxZ"]},znear:{type:"number",get:e=>e._babylonCamera?.minZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.minZ=e)},getTarget:e=>e,getPropertyName:[()=>"minZ"]}},perspective:{aspectRatio:{type:"number",get:e=>e._babylonCamera?.getEngine().getAspectRatio(e._babylonCamera),getTarget:e=>e,getPropertyName:[()=>"aspectRatio"],isReadOnly:!0},yfov:{type:"number",get:e=>e._babylonCamera?.fov,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.fov=e)},getTarget:e=>e,getPropertyName:[()=>"fov"]},zfar:{type:"number",get:e=>e._babylonCamera?.maxZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.maxZ=e)},getTarget:e=>e,getPropertyName:[()=>"maxZ"]},znear:{type:"number",get:e=>e._babylonCamera?.minZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.minZ=e)},getTarget:e=>e,getPropertyName:[()=>"minZ"]}}}},z={__array__:{__target__:!0,emissiveFactor:{type:"Color3",get:(e,t,r)=>i(e,t,r).emissiveColor,set:(e,t,r,o)=>i(t,r,o).emissiveColor.copyFrom(e),getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"emissiveColor"]},emissiveTexture:{extensions:{KHR_texture_transform:l("emissiveTexture")}},normalTexture:{scale:{type:"number",get:(e,t,r)=>f(e,r,"bumpTexture")?.level,set:(e,t,r,o)=>{let n=f(t,o,"bumpTexture");n&&(n.level=e)},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"level"]},extensions:{KHR_texture_transform:l("bumpTexture")}},occlusionTexture:{strength:{type:"number",get:(e,t,r)=>i(e,t,r).ambientTextureStrength,set:(e,t,r,o)=>{let n=i(t,r,o);n&&(n.ambientTextureStrength=e)},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"ambientTextureStrength"]},extensions:{KHR_texture_transform:l("ambientTexture")}},pbrMetallicRoughness:{baseColorFactor:{type:"Color4",get:(e,t,r)=>{let o=i(e,t,r);return A.FromColor3(o.albedoColor,o.alpha)},set:(e,t,r,o)=>{let n=i(t,r,o);n.albedoColor.set(e.r,e.g,e.b),n.alpha=e.a},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"albedoColor",()=>"alpha"]},baseColorTexture:{extensions:{KHR_texture_transform:l("albedoTexture")}},metallicFactor:{type:"number",get:(e,t,r)=>i(e,t,r).metallic,set:(e,t,r,o)=>{let n=i(t,r,o);n&&(n.metallic=e)},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"metallic"]},roughnessFactor:{type:"number",get:(e,t,r)=>i(e,t,r).roughness,set:(e,t,r,o)=>{let n=i(t,r,o);n&&(n.roughness=e)},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"roughness"]},metallicRoughnessTexture:{extensions:{KHR_texture_transform:l("metallicTexture")}}},extensions:{KHR_materials_anisotropy:{anisotropyStrength:{type:"number",get:(e,t,r)=>i(e,t,r).anisotropy.intensity,set:(e,t,r,o)=>{i(t,r,o).anisotropy.intensity=e},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"anisotropy.intensity"]},anisotropyRotation:{type:"number",get:(e,t,r)=>i(e,t,r).anisotropy.angle,set:(e,t,r,o)=>{i(t,r,o).anisotropy.angle=e},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"anisotropy.angle"]},anisotropyTexture:{extensions:{KHR_texture_transform:l("anisotropy","texture")}}},KHR_materials_clearcoat:{clearcoatFactor:{type:"number",get:(e,t,r)=>i(e,t,r).clearCoat.intensity,set:(e,t,r,o)=>{i(t,r,o).clearCoat.intensity=e},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"clearCoat.intensity"]},clearcoatRoughnessFactor:{type:"number",get:(e,t,r)=>i(e,t,r).clearCoat.roughness,set:(e,t,r,o)=>{i(t,r,o).clearCoat.roughness=e},getTarget:(e,t,r)=>i(e,t,r),getPropertyName:[()=>"clearCoat.roughness"]},clearcoatTexture:{extensions:{KHR_texture_transform:l("clearCoat","texture")}},clearcoatNormalTexture:{scale:{type:"number",get:(e,t,r)=>i(e,t,r).clearCoat.bumpTexture?.level,getTarget:i,set:(e,t,r,o)=>i(t,r,o).clearCoat.bumpTexture.level=e},extensions:{KHR_texture_transform:l("clearCoat","bumpTexture")}},clearcoatRoughnessTexture:{extensions:{KHR_texture_transform:l("clearCoat","textureRoughness")}}},KHR_materials_dispersion:{dispersion:{type:"number",get:(e,t,r)=>i(e,t,r).subSurface.dispersion,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.dispersion=e}},KHR_materials_emissive_strength:{emissiveStrength:{type:"number",get:(e,t,r)=>i(e,t,r).emissiveIntensity,getTarget:i,set:(e,t,r,o)=>i(t,r,o).emissiveIntensity=e}},KHR_materials_ior:{ior:{type:"number",get:(e,t,r)=>i(e,t,r).indexOfRefraction,getTarget:i,set:(e,t,r,o)=>i(t,r,o).indexOfRefraction=e}},KHR_materials_iridescence:{iridescenceFactor:{type:"number",get:(e,t,r)=>i(e,t,r).iridescence.intensity,getTarget:i,set:(e,t,r,o)=>i(t,r,o).iridescence.intensity=e},iridescenceIor:{type:"number",get:(e,t,r)=>i(e,t,r).iridescence.indexOfRefraction,getTarget:i,set:(e,t,r,o)=>i(t,r,o).iridescence.indexOfRefraction=e},iridescenceTexture:{extensions:{KHR_texture_transform:l("iridescence","texture")}},iridescenceThicknessMaximum:{type:"number",get:(e,t,r)=>i(e,t,r).iridescence.maximumThickness,getTarget:i,set:(e,t,r,o)=>i(t,r,o).iridescence.maximumThickness=e},iridescenceThicknessMinimum:{type:"number",get:(e,t,r)=>i(e,t,r).iridescence.minimumThickness,getTarget:i,set:(e,t,r,o)=>i(t,r,o).iridescence.minimumThickness=e},iridescenceThicknessTexture:{extensions:{KHR_texture_transform:l("iridescence","thicknessTexture")}}},KHR_materials_sheen:{sheenColorFactor:{type:"Color3",get:(e,t,r)=>i(e,t,r).sheen.color,getTarget:i,set:(e,t,r,o)=>i(t,r,o).sheen.color.copyFrom(e)},sheenColorTexture:{extensions:{KHR_texture_transform:l("sheen","texture")}},sheenRoughnessFactor:{type:"number",get:(e,t,r)=>i(e,t,r).sheen.intensity,getTarget:i,set:(e,t,r,o)=>i(t,r,o).sheen.intensity=e},sheenRoughnessTexture:{extensions:{KHR_texture_transform:l("sheen","thicknessTexture")}}},KHR_materials_specular:{specularFactor:{type:"number",get:(e,t,r)=>i(e,t,r).metallicF0Factor,getTarget:i,set:(e,t,r,o)=>i(t,r,o).metallicF0Factor=e,getPropertyName:[()=>"metallicF0Factor"]},specularColorFactor:{type:"Color3",get:(e,t,r)=>i(e,t,r).metallicReflectanceColor,getTarget:i,set:(e,t,r,o)=>i(t,r,o).metallicReflectanceColor.copyFrom(e),getPropertyName:[()=>"metallicReflectanceColor"]},specularTexture:{extensions:{KHR_texture_transform:l("metallicReflectanceTexture")}},specularColorTexture:{extensions:{KHR_texture_transform:l("reflectanceTexture")}}},KHR_materials_transmission:{transmissionFactor:{type:"number",get:(e,t,r)=>i(e,t,r).subSurface.refractionIntensity,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.refractionIntensity=e,getPropertyName:[()=>"subSurface.refractionIntensity"]},transmissionTexture:{extensions:{KHR_texture_transform:l("subSurface","refractionIntensityTexture")}}},KHR_materials_diffuse_transmission:{diffuseTransmissionFactor:{type:"number",get:(e,t,r)=>i(e,t,r).subSurface.translucencyIntensity,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.translucencyIntensity=e},diffuseTransmissionTexture:{extensions:{KHR_texture_transform:l("subSurface","translucencyIntensityTexture")}},diffuseTransmissionColorFactor:{type:"Color3",get:(e,t,r)=>i(e,t,r).subSurface.translucencyColor,getTarget:i,set:(e,t,r,o)=>e&&i(t,r,o).subSurface.translucencyColor?.copyFrom(e)},diffuseTransmissionColorTexture:{extensions:{KHR_texture_transform:l("subSurface","translucencyColorTexture")}}},KHR_materials_volume:{attenuationColor:{type:"Color3",get:(e,t,r)=>i(e,t,r).subSurface.tintColor,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.tintColor.copyFrom(e)},attenuationDistance:{type:"number",get:(e,t,r)=>i(e,t,r).subSurface.tintColorAtDistance,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.tintColorAtDistance=e},thicknessFactor:{type:"number",get:(e,t,r)=>i(e,t,r).subSurface.maximumThickness,getTarget:i,set:(e,t,r,o)=>i(t,r,o).subSurface.maximumThickness=e},thicknessTexture:{extensions:{KHR_texture_transform:l("subSurface","thicknessTexture")}}}}}},U={KHR_lights_punctual:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]},__array__:{__target__:!0,color:{type:"Color3",get:e=>e._babylonLight?.diffuse,set:(e,t)=>t._babylonLight?.diffuse.copyFrom(e),getTarget:e=>e._babylonLight,getPropertyName:[e=>"diffuse"]},intensity:{type:"number",get:e=>e._babylonLight?.intensity,set:(e,t)=>t._babylonLight?t._babylonLight.intensity=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"intensity"]},range:{type:"number",get:e=>e._babylonLight?.range,set:(e,t)=>t._babylonLight?t._babylonLight.range=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"range"]},spot:{innerConeAngle:{type:"number",get:e=>e._babylonLight?.innerAngle,set:(e,t)=>t._babylonLight?t._babylonLight.innerAngle=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"innerConeAngle"]},outerConeAngle:{type:"number",get:e=>e._babylonLight?.angle,set:(e,t)=>t._babylonLight?t._babylonLight.angle=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"outerConeAngle"]}}}}},EXT_lights_area:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]},__array__:{__target__:!0,color:{type:"Color3",get:e=>e._babylonLight?.diffuse,set:(e,t)=>t._babylonLight?.diffuse.copyFrom(e),getTarget:e=>e._babylonLight,getPropertyName:[e=>"diffuse"]},intensity:{type:"number",get:e=>e._babylonLight?.intensity,set:(e,t)=>t._babylonLight?t._babylonLight.intensity=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"intensity"]},size:{type:"number",get:e=>e._babylonLight?.height,set:(e,t)=>t._babylonLight?t._babylonLight.height=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"size"]},rect:{aspect:{type:"number",get:e=>e._babylonLight?.width/e._babylonLight?.height,set:(e,t)=>t._babylonLight?t._babylonLight.width=e*t._babylonLight.height:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"aspect"]}}}}},EXT_lights_ies:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]}}},EXT_lights_image_based:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonTexture),getPropertyName:[e=>"length"]},__array__:{__target__:!0,intensity:{type:"number",get:e=>e._babylonTexture?.level,set:(e,t)=>{t._babylonTexture&&(t._babylonTexture.level=e)},getTarget:e=>e._babylonTexture},rotation:{type:"Quaternion",get:e=>e._babylonTexture&&b.FromRotationMatrix(e._babylonTexture?.getReflectionTextureMatrix()),set:(e,t)=>{t._babylonTexture&&(t._babylonTexture.getScene()?.useRightHandedSystem||(e=b.Inverse(e)),c.FromQuaternionToRef(e,t._babylonTexture.getReflectionTextureMatrix()))},getTarget:e=>e._babylonTexture}}}}};function f(e,t,r,o){let n=i(e,t);return o?n[r][o]:n[r]}function i(e,t,r){return e._data?.[r?.fillMode??H.MATERIAL_TriangleFillMode]?.babylonMaterial}function l(e,t){return{offset:{componentsCount:2,type:"Vector2",get:(r,o,n)=>{let a=f(r,n,e,t);return new T(a?.uOffset,a?.vOffset)},getTarget:i,set:(r,o,n,a)=>{let s=f(o,a,e,t);s.uOffset=r.x,s.vOffset=r.y},getPropertyName:[()=>`${e}${t?"."+t:""}.uOffset`,()=>`${e}${t?"."+t:""}.vOffset`]},rotation:{type:"number",get:(r,o,n)=>f(r,n,e,t)?.wAng,getTarget:i,set:(r,o,n,a)=>f(o,a,e,t).wAng=r,getPropertyName:[()=>`${e}${t?"."+t:""}.wAng`]},scale:{componentsCount:2,type:"Vector2",get:(r,o,n)=>{let a=f(r,n,e,t);return new T(a?.uScale,a?.vScale)},getTarget:i,set:(r,o,n,a)=>{let s=f(o,a,e,t);s.uScale=r.x,s.vScale=r.y},getPropertyName:[()=>`${e}${t?"."+t:""}.uScale`,()=>`${e}${t?"."+t:""}.vScale`]}}}var N={cameras:O,nodes:V,materials:z,extensions:U,animations:E,meshes:B};function se(e){return new P(e,N)}function ge(e){let t=e.split("/").map(o=>o.replace(/{}/g,"__array__")),r=N;for(let o of t)o&&(r=r[o]);if(r&&r.type&&r.get)return r}function x(e,t){let r=e.split("/").map(n=>n.replace(/{}/g,"__array__")),o=N;for(let n of r)n&&(o=o[n]);o&&o.type&&o.get&&(o.interpolation=t)}function ue(e,t){let r=e.split("/").map(n=>n.replace(/{}/g,"__array__")),o=N;for(let n of r)if(n){if(!o[n]){if(n==="?"){o.__ignoreObjectTree__=!0;continue}o[n]={},n==="__array__"&&(o[n].__target__=!0)}o=o[n]}Object.assign(o,t)}function Z(e,t,r,o){return _.FromArray(t,r).scaleInPlace(o)}function I(e,t,r,o){return b.FromArray(t,r).scaleInPlace(o)}function k(e,t,r,o){let n=new Array(e._numMorphTargets);for(let a=0;a<n.length;a++)n[a]=t[r++]*o;return n}var j=class{constructor(t,r,o,n){this.type=t,this.name=r,this.getValue=o,this.getStride=n}_buildAnimation(t,r,o){let n=new y(t,this.name,r,this.type);return n.setKeys(o,!0),n}},d=class extends j{buildAnimations(t,r,o,n){let a=[];return a.push({babylonAnimatable:t._babylonTransformNode,babylonAnimation:this._buildAnimation(r,o,n)}),a}},M=class extends j{buildAnimations(t,r,o,n){let a=[];if(t._numMorphTargets)for(let s=0;s<t._numMorphTargets;s++){let h=new y(`${r}_${s}`,this.name,o,this.type);if(h.setKeys(n.map(g=>({frame:g.frame,inTangent:g.inTangent?g.inTangent[s]:void 0,value:g.value[s],outTangent:g.outTangent?g.outTangent[s]:void 0,interpolation:g.interpolation})),!0),t._primitiveBabylonMeshes){for(let g of t._primitiveBabylonMeshes)if(g.morphTargetManager){let C=g.morphTargetManager.getTarget(s),L=h.clone();C.animations.push(L),a.push({babylonAnimatable:C,babylonAnimation:L})}}}return a}};x("/nodes/{}/translation",[new d(y.ANIMATIONTYPE_VECTOR3,"position",Z,()=>3)]);x("/nodes/{}/rotation",[new d(y.ANIMATIONTYPE_QUATERNION,"rotationQuaternion",I,()=>4)]);x("/nodes/{}/scale",[new d(y.ANIMATIONTYPE_VECTOR3,"scaling",Z,()=>3)]);x("/nodes/{}/weights",[new M(y.ANIMATIONTYPE_FLOAT,"influence",k,e=>e._numMorphTargets)]);export{u as a,se as b,ge as c,x as d,ue as e,Z as f,I as g,k as h,j as i,d as j,M as k};
